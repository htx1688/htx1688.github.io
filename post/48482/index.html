<!DOCTYPE html>
<html
  lang="zh-cn"
  itemscope
  itemtype="http://schema.org/WebPage"
>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>
          USDC恐慌挤兑潮中的200万美元套利：认识危机中的MEV风险和机会 - 区块大全
        </title>
    

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="佚名" /><meta name="description" content="一个关于MEV的零基础快速入门指南" />
<meta name="keywords" content="MEV, USDC" />







<meta name="generator" content="Hugo 0.120.4" />


<link rel="canonical" href="/post/48482/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.d8d87b982993a745e5e7b6a6cbf257be8c3e82aab5e485f0908ad7e6c3501ab2.css" integrity="sha256-2Nh7mCmTp0Xl57amy/JXvow&#43;gqq15IXwkIrX5sNQGrI=" media="screen" crossorigin="anonymous">







<meta property="og:title" content="USDC恐慌挤兑潮中的200万美元套利：认识危机中的MEV风险和机会" />
<meta property="og:description" content="一个关于MEV的零基础快速入门指南" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/48482/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-03-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-03-15T00:00:00+00:00" />

<meta itemprop="name" content="USDC恐慌挤兑潮中的200万美元套利：认识危机中的MEV风险和机会">
<meta itemprop="description" content="一个关于MEV的零基础快速入门指南"><meta itemprop="datePublished" content="2023-03-15T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-03-15T00:00:00+00:00" />
<meta itemprop="wordCount" content="6863">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="USDC恐慌挤兑潮中的200万美元套利：认识危机中的MEV风险和机会"/>
<meta name="twitter:description" content="一个关于MEV的零基础快速入门指南"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




  </head>
  <body>
    <div id="back-to-top"></div>

    <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">区块大全</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="/categories/">分类</a>
          
        
      </li>
    

    
  </ul>
</nav>


    
      






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

    

    

    


    <header id="header" class="header">
      <div class="logo-wrapper">
  <a href="/" class="logo">
    
      区块大全
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="/categories/">分类</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

    </header>

    <div id="mobile-panel">
      <main id="main" class="main bg-llight wallpaper">
        <div class="content-wrapper">
    <div id="content" class="content">
      <article class="post">
        
        <header class="post-header">
          <h1 class="post-title">USDC恐慌挤兑潮中的200万美元套利：认识危机中的MEV风险和机会</h1>
          

          <div class="post-meta">
  <div class="post-meta-author">
    by
      佚名
    
  </div>

  <div class="post-meta-time">
    <time datetime="2023-03-15">
      2023-03-15
    </time>
  </div>

  


  <div class="post-meta__right">
    <span class="post-meta-more">
        约 6863 字 -
        预计阅读 14 分钟
      </span>

    <div class="post-meta-category">
        <a href="/categories/%E5%85%B6%E5%AE%83%E6%96%87%E7%AB%A0/"> 其它文章 </a>
          
      </div>


    
    


    
    
  </div>
</div>

        </header>

        
        <div class="post-content">
          <table>
    <thead>
        <tr>
            <th style="text-align:left">推荐平台</th>
            <th style="text-align:left">链接</th>
            <th style="text-align:left">平台介绍</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">币安网</span></td>
            <td style="text-align:left"><span style="white-space:nowrap"><a
                        href="https://www.okbtc.cn/binance?ref=githubio">注册链接</a></span></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/binance?ref=githubio">币安是全球领先的区块链生态系统，推出了一系列产品，其中包括最大的加密货币交易平台。我们的使命是在未来成为全球性加密货币基础架构供应商。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">欧易OKX</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/okx?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/okx?ref=githubio">欧易是全球著名的数字资产交易平台之一，主要面向全球用户提供比特币、莱特币、以太币等数字资产的币币和衍生品交易服务。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">HTX火币</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/htx?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/htx?ref=githubio">火币全球专业站，是火币集团旗下服务于全球专业交易用户的创新数字资产国际站，致力于发现优质的创新数字资产投资机会。</a>
            </td>
        </tr>
    </tbody>
</table>
<p>事件缘起</p>
<hr>
<p>2023年3月8日，硅谷银行（SVB）的母公司 SVB Financial Group 宣布亏本出售价值 210 亿美元的证券资产，以应对在美联储加息、科技股持续低迷背景下，用户提款造成的资金持续流出。亏本卖出资产以应对流动性危机的消息在市场上进一步引发了投资者的恐慌，9日，SVB Financial的股价暴跌60.41％，投资者和储户试图从硅谷银行撤资420亿美元，是10多年来美国最大的银行挤兑之一。10日，加州监管机构关闭了硅谷银行，并将其送入破产管理程序。</p>
<p>SVB倒闭的黑天鹅引发了一系列连锁危机，并蔓延至了加密市场。3月11日，稳定币USDC发行商 Circle 发推表示，在其共计约 400 亿美元的资金储备中，有大约 33 亿的现金储备存放在 SVB。Circle发布声明后，其对SVB的风险敞口同样引发市场的恐慌。为了减少损失，投资者开始抛售他们的 USDC 以换取如 Tether (USDT)的其他稳定币，USDC面临严重挤兑，其价格出现持续性脱锚，最低降至0.88 美元。同时，Binance、Coinbase 等中心化交易平台均宣布关闭 USDC 的部分兑换服务。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_zc7o5vw852.png" alt="zyMkuoZFiKZZBncgBzV2iNfNRNivp66IqfBeWXZ5.png"></p>
<p>在恐慌挤兑潮和一片市场混乱中，代币价格出现剧烈波动，MEV搜索者反而能够看到获利机会。而成为MEV目标的受害者，则可能不幸承受巨额损失。在本轮USDC挤兑潮中，就出现了一例这样的MEV套利事件。一位地址开头为0x8ff的投资者试图转换其稳定币仓位，想要将其持有的203万个3CRV代币换成USDT（3CRV 为Curve 流动池的LP 代币，由USDT、USDC、DAI 三种稳定币组成），但其并未直接通过Curve解除LP token，而是经由KyberSwap 聚合路由将交易发送给了Uniswap上的一个几乎完全没有流动性（仅有约2美元的流动资金）的LP，这个资金池在过去的 251 天里一直处于闲置状态。</p>
<p>此外，据推特用户@BowTiedPickle分析，除了KyberSwap 路由的问题外，这个巨鲸在匆忙之中很可能没有正确设置滑点，使得该笔交易不幸成为了MEV机器人套利的对象。</p>
<p>在该笔交易发送后，MEV机器人完成了一笔尾随交易，支付了45美元的Gas费和23.8个ETH（价值约3.9万美元）的builder小费，用1.45枚USDC在LP中换得了受害者发送的203万个3CRV，抢走了约204.5万美元的利润。而受害者发送的203万个3CRV，最终仅换回了0.05个USDT。</p>
<p>受害者交易：</p>
<p><a href="https://etherscan.io/tx/0xde46a6bb1fc7834dde4d01428c88f84d65a607f4dc11b7f3dd710e86b7d226a8">https://etherscan.io/tx/0xde46a6bb1fc7834dde4d01428c88f84d65a607f4dc11b7f3dd710e86b7d226a8</a></p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_nohw236smq.png" alt="kL9vzEcvcreDV7IkNGnS54Cn7LRPDAWjaOXH7a4z.png"></p>
<p><a href="https://eigenphi.io/mev/eigentx/0xde46a6bb1fc7834dde4d01428c88f84d65a607f4dc11b7f3dd710e86b7d226a8">https://eigenphi.io/mev/eigentx/0xde46a6bb1fc7834dde4d01428c88f84d65a607f4dc11b7f3dd710e86b7d226a8</a></p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_63a6iaerqg.png" alt="ArDEju4yG1rDN4bOZOKDJYtSrVWgVyxV8yV6miKZ.png"></p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_lkaqe79fyb.png" alt="WHebq2BozfAFXQxVF0ztlNLJ8yag1PcHrV7hBdqN.png"></p>
<p>MEV机器人的尾随交易：</p>
<p><a href="https://etherscan.io/tx/0x8a6be1e4db4375c1a1c9d1e5c5fcaa5c255b2d24f5da3de05f3b25d7c3508021">https://etherscan.io/tx/0x8a6be1e4db4375c1a1c9d1e5c5fcaa5c255b2d24f5da3de05f3b25d7c3508021</a></p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_1s6spd4y0c.png" alt="P23rHZBVUvgVaO14WHfmS4hQJYRLsrvlUCFF0xnK.png"></p>
<p><a href="https://eigenphi.io/mev/eigentx/0x8a6be1e4db4375c1a1c9d1e5c5fcaa5c255b2d24f5da3de05f3b25d7c3508021">https://eigenphi.io/mev/eigentx/0x8a6be1e4db4375c1a1c9d1e5c5fcaa5c255b2d24f5da3de05f3b25d7c3508021</a></p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_fl6yu4u7vt.png" alt="KIg0ZeIZLTsb3lueBCtGEyDvPi12bs4WwLn11LRc.png"></p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_aiszylfaba.png" alt="L39JdpUvucCxmwKIS4zzMBp6tWlRlCfKtImErcqf.png"></p>
<p>在DeFi生态中，MEV是交易者在DEX中进行代币兑换过程中最头疼但也难以绕开的风险问题。特别是在危机中，MEV反而是在动荡市场中最具活力和破坏性的存在。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_wm6a6csmsy.png" alt="WidLQgS9DUH1ZZsLz7JKz60LwNBhfTLetKMjloOg.png"></p>
<p>什么是MEV？它如何为交易者带来利润？一个完整的套利交易过程是什么样的？如何利用DeFi的闪电贷功能实现“零本万利”的回报？本文的目的旨在回答上述问题，为对MEV有兴趣的交易者提供入门指南。欢迎来到MEV的世界。</p>
<h2 id="mev概述">MEV概述</h2>
<p>在工作量证明（PoW）的背景下，MEV最初是指矿工可提取价值（Miners extractable value），即指代矿工通过在其生产的区块内任意添加、排除或重新排序交易的能力可以获得的利润。</p>
<p>随着以太坊合并（Merge），加入权益证明共识层（PoS）后，实行了提议者 / 构建者分离 (PBS：Proposer/Builder Separation)，将收集交易及提议区块的角色和排序构建区块的角色（即确定哪些交易以何种顺序包含在区块中）分开。其中，之前矿工的角色由PoS网络中的验证者（Validator）负责。在PoS的背景下，MEV的定义扩展为了最大提取价值 (Maximal extractable value) ，指验证者通过添加、删除并更改区块中的交易顺序，在超过标准区块奖励和 gas 费用的区块生产中所能提取的最大价值。</p>
<p>虽然从理论上讲，MEV应该完全由验证者获得，因为他们是唯一能够保证将套利机会付诸实践的一方。然而，实际中MEV并不会完全被验证者所提取，而是可能被称为“搜索者（searcher）”的套利交易者和机器人（MEV-bot）所瓜分。</p>
<p>事实上，MEV的逻辑和证券交易中的高频交易（HFT）类似。在基于自动做市商（AMM）的DEX中，每一笔交易都会产生滑点：每出售一美元资产，就会将新的兑换价格压低一点。这为那些想通过价格差异赚取利润的搜索者提供了可能。MEV搜索者依靠以太坊区块中交易的特定顺序来赚取利润。他们通过扫描区块链数据来捕获普通用户的 DEX 交易，并从不同DEX之间的价差中寻找潜在的套利机会，然后支付高额gas费用以抢占先机。在一般情况下，MEV也是发生在链上套利交易的总称。</p>
<h2 id="mev的几种类型">MEV的几种类型</h2>
<h3 id="抢先交易-front-runs"><strong>抢先交易 (front-runs)</strong></h3>
<p>这种类型的 MEV指在内存池(mempool)中的已知交易之前执行交易。MEV搜索者会扫描内存池以寻找可盈利的交易。例如，如果MEV机器人发现了一笔大额交易，它会复制用户的交易并支付更高的 gas 费用，以确保在区块的交易顺序中处于最高优先级，能够被更早确认。</p>
<h3 id="尾随交易-back-runs"><strong>尾随交易 (back-runs)</strong></h3>
<p>尾随交易指在已知待处理交易之后立即放置交易。搜索者通常使用此类机器人来监控内存池中的新代币对列表或在Uniswap等 DEX 上创建的流动性池，在发现新的代币对上市后，机器人可以在初始流动性之后立即下达交易订单，并购买尽可能多的代币，只留下少量供其他交易者购买。通过尾随交易，机器人可以在某个代币以极低的价格购买流动性池中出售的代币，然后在另一家交易所溢价出售，这笔溢价（减去交易费）就是搜索者的利润。与抢先交易不同，尾随交易可能是MEV机器人向网络发送很多相同的交易，其附加的交易费用会略高于目标交易，因此这可能会造成网络拥堵。</p>
<h3 id="套利"><strong>套利</strong></h3>
<p>套利的基础逻辑就是在不同的DEX流动性资金池（Liquidity Pool）之间进行“低买高卖”，利用兑换价差赚取利润。</p>
<p>双边套利又称作直接套利，它是通过发现同一交易对（如WETH/USDC）在两个资金池间存在的价差关系，进行高卖低买，并从中套取差价利润。一个典型的双边套利过程如下：</p>
<p>首先，搜索者通过扫描链上数据，发现在Uniswap V3的一个资金池LP1中，WETH/USDC的兑换价格是1300；在另一个资金池LP2中，WETH/USDC的兑换价格是1305。那么，搜索者可以利用兑换价差，①在LP1用130,000个USDC兑换100个WETH，②并在LP2将这100个WETH兑换为130,500个USDC，③这两笔兑换交易需要向网络支付gas费用，一共0.02个ETH。综上，搜索者可获得的总收入是500个USDC，净利润等于500 USDC减去0.02 ETH的费用。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_e0z8wr1p5h.png" alt="vqhCfHrvhJgjStaBuYnjU6LXf0ctgozb1oZb7oY9.png"></p>
<p>图：双边套利流程示意图</p>
<p>在简单的双边套利基础上，搜索者还可以扫描三个及以上的资金池之间的代币对价差（如WETH/USDC, WETH/DAI, DAI/USDC），通过三次、四次及以上不断兑换不同的代币对，实现套利。</p>
<p>一个三边套利的流程如下：首先，假设发现在LP1中，WETH/USDC的兑换价格是1300；在另一个资金池LP2中，WETH/DAI的兑换价格是1305；在LP3中，DAI/USDC的兑换价格是1.1。那么，搜索者可以利用兑换价差，①在LP1用130,000个USDC兑换100个WETH，②在LP2将这100个WETH兑换为130,500个DAI，③在LP3将130,500 DAI兑换为143,550 USDC。这三笔兑换交易需要向网络支付gas费用，一共0.03个ETH。综上，搜索者可获得的总收入是13,550个USDC，净利润等于13,550 USDC减去0.03 ETH的费用。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_b8wqhq8uc3.png" alt="6KUzsUwj2PIoiGXhPCsXxKaR76gzytKL5z7rdZVV.png"></p>
<p>图：三边套利流程示意图</p>
<p>以此类推，在实际的套利交易中，搜索者还可以从多个资金池中利用多个代币对的价差实现低买高卖的套利。目前，通过智能合约，MEV机器人甚至可以瞬时间内，从上百个资金池中完成上百个代币对的兑换。例如，下面这个套利交易中，MEV机器人就在172个资金池中完成了代币对兑换，共涉及81种代币。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_nfqsac3a29.png" alt="XzoYGzP3Hr9Fbt8RR5Im76FokqfdK5wD3hZvoesz.png"></p>
<p>对于整个市场来说，套利交易实际上起到了“价格发现”的作用。换句话说，通过上述套利交易，不同交易资金池中的代币对兑换价差会减小并趋向一致，实际上能够提高市场效率。然而，接下来要介绍的三明治攻击是最为糟糕的MEV类型，其实际上是损害了市场中投资者的利益。</p>
<h3 id="三明治攻击"><strong>三明治攻击</strong></h3>
<p>三明治MEV的存在是因为DeFi交易用户必须将预期的交易发送到区块链的内存池（memepool）等待确认。换言之，这些交易并不是即时放上区块，而是根据支付的gas费/优先费用在区块内排序的。而MEV机器人通常会在内存池中寻找特定交易，并试图根据预定的算法进行抢先交易或尾随交易。</p>
<p>一个典型的三明治过程如下：首先，搜索者发现有一个用户发送了一笔交易，想用130,500 USDC兑换WETH。此时资金池中WETH/USDC的兑换价格是1300。搜索者这时可以①发送一笔用130,000 USDC 兑换WETH的交易，并支付更高的gas费用以提前交易顺序，完成抢先交易，以1300的兑换价格购买了100 WETH。如上文所述，每一笔兑换都可能在DEX中产生滑点。在抢先交易后，假设DEX中的WETH/USDC的价格被拉升至1305。②用户初始提交的130,500 USDC兑换WETH的交易得到执行，以新的兑换价格购买了100 WETH。③搜索者同时发送一笔尾随交易，以1305的价格用100 WETH兑换回了130,500 USDC。综上，搜索者可获得的总收入是500个USDC。假设为了保证抢先交易的执行需要支付的优先gas费用是0.05 ETH，那么净利润等于500 USDC减去0.05 ETH。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_4go3ppcuuq.png" alt="HH1ivbTgjGevoA9vw3z46IqtLeNgheJYIujY5wCa.png"></p>
<p>从上述流程不难看出，三明治攻击并没有提高市场效率；相反，它给最开始发送交易的用户带来了损失，给市场参与者带来了更高的交易风险。在T1时刻下，WETH/USDC兑换价格为1300，因此受害者实际上可以本应该获得约100.384个WETH。然而，由于搜索者的抢先交易拉升了WETH/USDC的兑换价格，受害者最终只获得了100个WETH，其损失为0.384个WETH，折合为500 USDC。搜索者的攻击为其带来了500 USDC的收入，这笔收入实际上是对受害者的一种“抢劫”。</p>
<h3 id="清算"><strong>清算</strong></h3>
<p>通常来说，诸如AAVE、Compound等借贷协议会要求用户存入一定数额的资产作为抵押品，然后将这些存入的抵押品借出给其他用户。随着抵押资产价值的波动，用户的借贷能力也随之波动。当借款人的抵押品价值不足以弥补其债务价值时，借贷协议就会对借款人进行清算，而市场中任何人都能够完成清算。为了激励清算，协议向借款人收取清算费，并将其中一部分费用交给清算人。因此，搜索者会竞相监控所有借款人的头寸，以确定哪些借款人可以被清算，并成为第一个提交清算交易并收取清算费的人。</p>
<h2 id="基于闪电贷的mev链上套利">基于闪电贷的MEV链上套利</h2>
<h3 id="闪电贷"><strong>闪电贷</strong></h3>
<p>区块上可以包含多笔交易，而一个交易里面可以执行多个操作，只要是这个交易的最终状态是正确的，就可以完成操作。鉴于这种特点，DeFi借贷平台AAVE创造了“闪电贷（flash loan）”。闪电贷是一种即时的无抵押贷款，允许用户在没有抵押品的情况下从链式流动性池中借入资产，但是借入的资产必须在同一区块链交易中偿还。这意味着借款人必须调用智能合约，在交易结束前即时还款，并按一定比例支付贷款服务费。因为交易结束通常是几秒钟，这种借贷行为被称为闪电贷。如果借款人没有在同一交易中偿还贷款，则整个交易将被撤销，包括初始借入和之后采取的任何操作。闪电贷可以为DeFi用户提供低成本、即时的流动性，目前已有多家协议（如AAVE、Balancer Vault、Uniswap V3、dYdX等）提供闪电贷服务，这为流动性不足的MEV搜索者创造了“一本万利”甚至“零本万利”的机会。接下来文章将介绍如何利用闪电贷实现无风险套利。</p>
<h3 id="套利交易分析实战"><strong>套利交易分析实战</strong></h3>
<p>目前可用于分析MEV交易的数据产品有EigenPhi、zeromev、flash bots的MEV-Explore等，下文将利用EigenPhi的EigenTx可视化工具，对一笔真实的闪电贷套利交易进行分析。在这笔交易中</p>
<p>（0x2ac586b83b5222cac59c854cca1e202605919fe2fdacfbef1d2e0489bbb26e53），搜索者以$5.6的成本，获得了$11,981的净利润。</p>
<p>下图呈现了一笔利用Uniswap V3的闪电贷套利交易的代币流向。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_w87u34zezq.png" alt="vZ6g7qEYimxJX7JeJOEMkP74Sy3ORoTFM1bbC42G.png"></p>
<p>图上共五个交易节点：两个WOOL/WETH代币对流动性池（UNI-V2 LP1与UNI-V3 LP2），to地址（即搜索者提交的智能合约地址），闪电贷借贷协议（UniswapV3Pool），以及搜索者的钱包地址（leaf叶子节点）。</p>
<p>该笔交易整体的套利逻辑是：搜索者发现在两个流动性池（LP1位于Uniswap V2，LP2位于Uniswap V3）中，WOOL/WETH代币对的兑换价格存在差价，具有套利空间。搜索者先是在LP1中用1.1474 WETH兑换了851,424 WOOL（见图中步骤1,2），并将换到的851,424 WOOL在LP2中换回了11.4902 WETH（见步骤3,4）。该笔套利的收入等于步骤3获得的11.4902 WETH减去步骤1付出的1.1474 WETH，即约10.34 WETH。</p>
<p>而在上述套利的过程中，步骤1的“启动资金”，即1.1474WETH，是从Uniswap V3借得的闪电贷（见步骤0）。待到完成套利，搜索者偿还了该笔闪电贷并支付了服务费，共归还平台1.1479 WETH（见步骤5）。最终，搜索者从这笔交易中获得的利润等于其收入（10.34 WETH）减去闪电贷服务费与gas费用（见步骤6）。</p>
<p>需要注意的是，虽然上述图将整个交易拆分为了几个步骤，但在智能合约中上述步骤都是同时完成的。搜索者甚至不需要支付初始资本就能完成套利，因此这笔交易其实是零成本的“空手套白狼”。</p>
<p>对于三明治攻击者来说，其闪电贷的使用逻辑也是类似的。搜索者可以使用闪电贷即时借出大额资金，在抢先交易阶段制造更大的滑点。等到受害者的交易被执行，搜索者只需要紧接着在尾随交易中偿还该笔闪电贷即可。由于三笔交易（搜索者的抢先交易、受害者的交易、搜索者的尾随交易）都是同时被验证并被记录上区块，闪电贷的借款-偿付同样能顺利完成。</p>
<h2 id="总结">总结</h2>
<p>MEV是DeFi生态的特别产物，其中像套利和清算能够促进市场效率，但三明治攻击则会威胁每一个DeFi交易者。根据MEV-Explore的数据，目前以太坊上的MEV累计利润已经达到了6.87亿美元。随着以太坊合并，MEV的活跃度有所抑制，但仍是不可忽视的市场干扰力量。</p>
<p><img src="https://img.bibiqing.com/news/2023/0315/13_hyrwf3yv97.png" alt="mfVfFJmQGdUx87Nqw2mopwLNi68qBvtErPVfQ8l3.png"></p>
<p>本文的目的在于对MEV的概念和交易基础逻辑进行快速入门，涉及的概念都相对基础。但在真实的DeFi世界，不乏各种组合式套利类型和新式三明治攻击。无论是如果你是想规避链上风险，还是想成为一名合格的MEV搜索者，都不妨以此文作为指南，开始你的MEV进阶之旅。</p>
<h2 id="参考">参考</h2>
<ul>
<li>
<p>以太坊开发文档https://ethereum.org/en/developers/docs/mev/</p>
</li>
<li>
<p>MEV 的第一个五年：从 Flashbots 诞生前说起 <a href="https://foresightnews.pro/article/detail/22060">https://foresightnews.pro/article/detail/22060</a></p>
</li>
<li>
<p>MEV 的下一个五年：读懂 MEV 领域最新趋势 <a href="https://foresightnews.pro/article/detail/23394">https://foresightnews.pro/article/detail/23394</a></p>
</li>
<li>
<p>一文读懂 MEV 链上套利 <a href="https://foresightnews.pro/article/detail/16585">https://foresightnews.pro/article/detail/16585</a></p>
</li>
<li>
<p>深度研究：MEV 的过去、现状与未来 <a href="https://foresightnews.pro/article/detail/18044">https://foresightnews.pro/article/detail/18044</a></p>
</li>
<li>
<p>深度| 一文全览 MEV 前沿发展与赛道项目全景图 <a href="https://www.defidaonews.com/article/6790242">https://www.defidaonews.com/article/6790242</a></p>
</li>
<li>
<p>The 0 to 1 Guide for MEV <a href="https://calblockchain.mirror.xyz/c56CHOu-Wow">https://calblockchain.mirror.xyz/c56CHOu-Wow</a>_50qPp2Wlg0rhUvdz1HLbGSUWlB_KX9o</p>
</li>
<li>
<p>EigenPhi Classroom <a href="https://eigenphi-1.gitbook.io/classroom/">https://eigenphi-1.gitbook.io/classroom/</a></p>
</li>
<li>
<p>MEV是不是一个好的投资机会？https://mp.weixin.qq.com/s/s7fTlOIlxP92w5fK7wsE3Q</p>
</li>
<li>
<p>Ethereum is a Dark Forest <a href="https://www.paradigm.xyz/2020/08/ethereum-is-a-dark-forest">https://www.paradigm.xyz/2020/08/ethereum-is-a-dark-forest</a></p>
</li>
<li>
<p>一文看懂MEV是如何产生的，以及它在以太坊网络中的流动机制 <a href="https://cointelegraphcn.com/news/best-understand-mev">https://cointelegraphcn.com/news/best-understand-mev</a></p>
</li>
<li>
<p>AAVE&rsquo;s documentation of flash loans <a href="https://docs.aave.com/developers/guides/flash-loans">https://docs.aave.com/developers/guides/flash-loans</a></p>
</li>
<li>
<p>What Is a Flash Loan? A guide to one of DeFi’s most innovative and controversial features. <a href="https://www.coindesk.com/learn/what-is-a-flash-loan/">https://www.coindesk.com/learn/what-is-a-flash-loan/</a></p>
</li>
<li>
<p>Aave and Flash Loans: Uncollateralized Lending in DeFi <a href="https://www.gemini.com/cryptopedia/aave-flashloans">https://www.gemini.com/cryptopedia/aave-flashloans</a></p>
</li>
<li>
<p>What Are Flash Loans? <a href="https://chain.link/education-hub/flash-loans">https://chain.link/education-hub/flash-loans</a></p>
</li>
<li>
<p>How to Use AAVE Loan to Launch a Sandwich MEV Attack? <a href="https://eigenphi.substack.com/p/aave-loan-sandwich-attack">https://eigenphi.substack.com/p/aave-loan-sandwich-attack</a></p>
</li>
<li>
<p>Get Everything for Nothing: How to Use Flash Loans to Launch an Arbitrage? <a href="https://eigenphi.substack.com/p/complicated-flash-loan-mev">https://eigenphi.substack.com/p/complicated-flash-loan-mev</a></p>
</li>
<li>
<p>What Is MEV, aka Maximal Extractable Value? <a href="https://www.coindesk.com/learn/what-is-mev-aka-maximal-extractable-value/">https://www.coindesk.com/learn/what-is-mev-aka-maximal-extractable-value/</a></p>
</li>
<li>
<p>Ethereum’s Hidden Tax: Maximal Extractable Value (MEV) <a href="https://www.treehouse.finance/insights/ethereums-hidden-tax-maximal-extractable-value-mevhttps://www.mev.wiki/">https://www.treehouse.finance/insights/ethereums-hidden-tax-maximal-extractable-value-mevhttps://www.mev.wiki/</a></p>
</li>
</ul>
<table>
    <thead>
        <tr>
            <th style="text-align:left">推荐平台</th>
            <th style="text-align:left">链接</th>
            <th style="text-align:left">平台介绍</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">Gate芝麻开门</span></td>
            <td style="text-align:left"><span style="white-space:nowrap"><a
                        href="https://www.okbtc.cn/gateio?ref=githubio">平台介绍</a></span></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/gateio?ref=githubio">Gate.io芝麻开门创立于2013年，是全球真实交易量TOP10的加密货币交易平台，向全球数千万用户提供安全可靠、真实透明的数字资产交易服务。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">Bitget</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/bitget?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/bitget?ref=githubio">Bitget的背后是一群区块链技术的早期接受者，也是区块链未来发展的信仰者，一直致力于提供安全、一站式的交易解决方案，帮助用户更聪明地交易。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">Bybit</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/bybit?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/bybit?ref=githubio">Bybit通过数字资产与传统金融的结合，引领数字资产的生态发展。提供一流的流动性，致力于打造业内最安全、公平、高效及人性化的交易服务平台。</a>
            </td>
        </tr>
        <tr>
            <td style="text-align:left"><span style="white-space:nowrap">派网</span></td>
            <td style="text-align:left"><a href="https://www.okbtc.cn/pionex?ref=githubio">注册链接</a></td>
            <td style="text-align:left"><a
                    href="https://www.okbtc.cn/pionex?ref=githubio">派网提供多样化的量化交易机器人，用户可依照自身交易需求和策略选择最适合的机器人。 同时派网也提供合约交易与合约网格机器人，给予更方便的合约交易体验。</a>
            </td>
        </tr>
    </tbody>
</table>

        </div>

        
        



        
        


        <footer class="post-footer">
          


          
          <nav class="post-nav">
            
              <a class="prev" href="/post/48477/">
                
                <i class="iconfont">
                  <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

                </i>
                <span class="prev-text nav-default">OpenAI正式推出多模态GPT-4</span>
                <span class="prev-text nav-mobile">上一篇</span>
              </a>
            
              <a class="next" href="/post/48496/">
                <span class="next-text nav-default">Web3 的阴暗面：去中心化如何助长 AI 偏见</span>
                <span class="prev-text nav-mobile">下一篇</span>
                
                <i class="iconfont">
                  <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

                </i>
              </a>
          </nav>
        </footer>
      </article>

      
      
        
      


      
      


    </div>

    
    <nav class="toc" id="toc">
    <div class="toc-title">文章目录</div>
    <div class="toc-content custom-scrollbar">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#mev概述">MEV概述</a></li>
    <li><a href="#mev的几种类型">MEV的几种类型</a>
      <ul>
        <li><a href="#抢先交易-front-runs"><strong>抢先交易 (front-runs)</strong></a></li>
        <li><a href="#尾随交易-back-runs"><strong>尾随交易 (back-runs)</strong></a></li>
        <li><a href="#套利"><strong>套利</strong></a></li>
        <li><a href="#三明治攻击"><strong>三明治攻击</strong></a></li>
        <li><a href="#清算"><strong>清算</strong></a></li>
      </ul>
    </li>
    <li><a href="#基于闪电贷的mev链上套利">基于闪电贷的MEV链上套利</a>
      <ul>
        <li><a href="#闪电贷"><strong>闪电贷</strong></a></li>
        <li><a href="#套利交易分析实战"><strong>套利交易分析实战</strong></a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
    <li><a href="#参考">参考</a></li>
  </ul>
</nav>
    </div>
  </nav>


  </div>

      </main>

      <footer id="footer" class="footer">
        <div class="icon-links">
  

<a href="https://www.okbtc.cn/binance?ref=githubio" class="iconfont">
  <img src="/image/logo/binance.png" width="36px" height="36px" alt="binance">
</a>

<a href="https://www.okbtc.cn/okx?ref=githubio" class="iconfont">
  <img src="/image/logo/okx.png" width="36px" height="36px" alt="okx">
</a>

<a href="https://www.okbtc.cn/htx?ref=githubio" class="iconfont">
  <img src="/image/logo/htx.png" width="36px" height="36px" alt="htx">
</a>

<a href="https://www.okbtc.cn/gateio?ref=githubio" class="iconfont">
  <img src="/image/logo/gateio.png" width="36px" height="36px" alt="gateio">
</a>

<a href="https://www.okbtc.cn/bitget?ref=githubio" class="iconfont">
  <img src="/image/logo/bitget.png" width="36px" height="36px" alt="bitget">
</a>

<a href="https://www.okbtc.cn/bybit?ref=githubio" class="iconfont">
  <img src="/image/logo/bybit.png" width="36px" height="36px" alt="bybit">
</a>

<a href="https://www.okbtc.cn/pionex?ref=githubio" class="iconfont">
  <img src="/image/logo/pionex.png" width="36px" height="36px" alt="pionex">
</a>



</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    2023
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        coin
        
      </span></span>

  
  

  
</div>

      </footer>

      <div class="button__back-to-top">
        <a href="#back-to-top">
          <i class="iconfont">
            
            <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

          </i>
        </a>
      </div>
    </div>
    
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.5e8c82c5ae3f71b40f78c4ff8ea351326a65ddf5771f76c10c6fc7d09808332d.js" integrity="sha256-XoyCxa4/cbQPeMT/jqNRMmpl3fV3H3bBDG/H0JgIMy0=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  











<script>
  var remark_config = {
    host: 'https:\/\/remark42.example.com',
    site_id: 'remark',
    components: [
	    'embed',
    ],
  }
  !function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);
</script>







  </body>
</html>
